# Описание папок:

## area_delay_data_preprocessing:

В ней содержится скрипт, выделяющий 11 признаков графа из файла .graphml, .csv файлы с этими признаками и таргетами. Данный скрипт не используется в финальном скрипте для предсказания.

## area_delay_models:

В папке находятся простые модели для предсказания площади и задержки и скрипт для их тренировки. Данные модели не используюся в финальном скрипте для предсказания.

## DGI_model:

В папке содержится шаблон DGI энкодера (encoder.py), зависящий от параметров input_size (количество признаков вершин графов), hidden_channels (количеством скрытых каналов сверточных слоев), conv (тип графовых сверточных слоев), n_output (= 2\*hidden_channels, размер эмбеддинга). 
Также в ней содержится скрипт для тренировки, в котором есть: функция train(model, dataset, epochs, optimizer, device), датасет LargeDatasetB(file_path, N) (file_path - путь к папке, в которой находят 150 синтезов каждой модели, N - сколько синтезов каждой модели брать), функция main(), реализующая тренировку модели 2 эпохи на датасете DATASET_PATH, с количеством скрытых каналов сверточных слоев HIDDEN_CHANNELS.
Скрипт make_X_emb.py содержит функцию make_X_emb(encoder, dataset, X_emb_path) (dataset - LargeDatasetB, X_emb_path - путь к файлу .pt вместе с его названием) данная функция создает .pt файл с эмбеддингами всех графов из датасета.

## final_prediction_script:

Подробно описан в пользовательской докуменции.

## gb_model:

Папка содержит модель с подобранными гиперпараметрами (model.py), скрипт для тренировки (train.py) содержит функцию train, которая принимает на вход модель, путь к файлу .pt, содержащему эмбеддинги графов, путь к .csv файлу с признаками графов, путь .csv файлу с площадью и задержкой микросхем, количество фолдов для кросс-валидации.

## GNN_data_preprocessing:

Содержит скрипт A_X_from_graphml.py, функция main() которого считывает файлы .graphml из папки FOLDER_PATH, создает в папке TARGET_PATH файлы матриц смежности и признаков вершин графов параллельно, в 12 потоков.
Скрипт concat_batches.py конкатенирует n_batch графов в один, содержит функцию main(folder_path, target_path, batch_path, n_batch), первые 2 параметра аналогичны предыдущему скрипту, batch_path - путь к папке, куда будут записываться батчи графов, n_batch - размер батча. Скрипт может вызываться из командной строки с теми же параметрами. Данный скрипт не использовался в финальном скрипте для предсказания.

## GNN_models:

В папке находится скрипт model.py, содержащий 3-хслойную (GNN3) и 2-xслойную (GNN) графовые нейронные сети. Модели зависят от параметров input_size (количество признаков вершин графов), hidden_channels (количеством скрытых каналов сверточных слоев), conv (тип графовых сверточных слоев), n_output (размер эмбеддинга).
Скрипт train.py содержит функцию train_model(model, dataset, batch_train_sampler, val_loader, criterion, optimizer, num_epochs, device), датасет BatchDataset(file_path), функцию main(), в которой реализовано обучение нейронной сети GNN на датасете BATCHES_PATH.
Данные скрипты не исользуются в финальном скрипте.

## prediction_script_1

Устаревшая версия финального скрипта, не используется.

## Автор: Тюняткин Петр